
{
  "rules": {
    "users": {
      "$uid": {
        // A user can read their own profile, or an admin can read any profile.
        ".read": "auth != null && (auth.uid == $uid || root.child('users').child(auth.uid).child('role').val() == 'admin')",
        // A user can write to their own profile, or an admin can write to any profile.
        ".write": "auth != null && (auth.uid == $uid || root.child('users').child(auth.uid).child('role').val() == 'admin')"
      }
    },
    "menuItems": {
      // Anyone can read the menu.
      ".read": true,
      // Only admins can write to menu items.
      ".write": "auth != null && root.child('users').child(auth.uid).child('role').val() == 'admin'"
    },
    "preOrders": {
      // Admins and volunteers can read all pre-orders.
      ".read": "auth != null && (root.child('users').child(auth.uid).child('role').val() == 'admin' || root.child('users').child(auth.uid).child('role').val() == 'volunteer')",
      "$orderId": {
        // Anyone can create a new pre-order.
        // Admins and volunteers can update an existing one.
        ".write": "auth != null || (newData.exists() && !data.exists())"
      }
    },
    "sales": {
       // Admins and volunteers can create sales.
      ".write": "auth != null && (root.child('users').child(auth.uid).child('role').val() == 'admin' || root.child('users').child(auth.uid).child('role').val() == 'volunteer')",
       // Only admins and volunteers can read sales data.
      ".read": "auth != null && (root.child('users').child(auth.uid).child('role').val() == 'admin' || root.child('users').child(auth.uid).child('role').val() == 'volunteer')"
    }
  }
}
